{
  "type": "VerticalLayout", 
   "actions":[
    {
      "scope": "#/properties/count",
      "kind": "calc",
      "behavior": ["on-change", "on-init"],
      "script": "console.log('filtered_employees: ', filtered_employees); return filtered_employees && filtered_employees.length;",
      "depends": ["#/properties/filtered_employees"]
    },
    {
      "scope": "#/properties/employees",
      "kind": "rest",
      "depends": "#/properties/refresh",
      "behavior": "on-change",
      "method": "get",
      "url": "http://localhost:3001/employees"
    },
    {
      "id": "upper-filter",
      "scope": "#/properties/upper_filter",
      "kind": "calc",
      "behavior": "on-change",
      "script": "return filter && filter.toUpperCase();",
      "depends": ["#/properties/filter"]
    },
    
    {
      "id": "filter-employees",
      "scope": "#/properties/filtered_employees",
      "kind": "calc",
      "behavior": ["on-change", "on-init"],
      "script": "return employees.filter(e=>filter === undefined || filter === '' || e.name?.includes(filter) || e.surname?.includes(filter));",
      "depends": ["#/properties/employees", "#/properties/filter"]
    }
  ],
  "elements": [
    {
      "type": "VerticalLayout",
      "elements": [
        {
          "type": "HorizontalLayout",
          "elements": [
            {
              "type": "Control",
              "scope": "#/properties/refresh",
              "options": {
                "refresh": true,
                "actionScopes": [
                  "#/properties/employees",
                  "#/properties/filtered_employees"
                ]
              }
            },
            {
              "type": "Control",
              "label": "Seacrh by name",
              "scope": "#/properties/filter"
            }
          ]
        },
        {
          "type": "Control",
          "scope": "#/properties/employees",
          "options":{
            "readonly": true
          }
        },
        {
          "type": "Control",
          "scope": "#/properties/filtered_employees"
        },
        {
          "type": "Control",
          "label": "Upper case filter",
          "scope": "#/properties/upper_filter",
          "options": {
            "readonly": true
          }
        },
        {
          "type": "Control",
          "label": "Total employees",
          "scope": "#/properties/count"
        }
      ]
    }
  ]
}
